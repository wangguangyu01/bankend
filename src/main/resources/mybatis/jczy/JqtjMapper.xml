<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.smart119.jczy.dao.JqtjDao">

	<!-- 可根据自己的需求，是否要使用 -->
	<resultMap type="com.smart119.webapi.domain.JbxxDO" id="jbxxMap">
					<result property="jqTywysbm" column="JQ_TYWYSBM"/>
					<result property="bjTywysbm" column="BJ_TYWYSBM"/>
					<result property="mc" column="MC"/>
					<result property="ddmc" column="DDMC"/>
					<result property="jqflydm" column="JQFLYDM"/>
					<result property="jqdjdm" column="JQDJDM"/>
					<result property="jqztLbdm" column="JQZT_LBDM"/>
					<result property="jqztRqsj" column="JQZT_RQSJ"/>
					<result property="jqdxTywysbm" column="JQDX_TYWYSBM"/>
					<result property="jqdxMc" column="JQDX_MC"/>
					<result property="jqdxJyqk" column="JQDX_JYQK"/>
					<result property="jqJyqk" column="JQ_JYQK"/>
					<result property="jqbslbdm" column="JQBSLBDM"/>
					<result property="lc" column="LC"/>
					<result property="dqjd" column="DQJD"/>
					<result property="dqwd" column="DQWD"/>
					<result property="bjrxm" column="BJRXM"/>
					<result property="bjdh" column="BJDH"/>
					<result property="bjfslbdm" column="BJFSLBDM"/>
					<result property="bjsj" column="BJSJ"/>
					<result property="lasj" column="LASJ"/>
					<result property="jasj" column="JASJ"/>
					<result property="jsmlsj" column="JSMLSJ"/>
					<result property="cdsj" column="CDSJ"/>
					<result property="dcsj" column="DCSJ"/>
					<result property="zdzksj" column="ZDZKSJ"/>
					<result property="cssj" column="CSSJ"/>
					<result property="hskzsj" column="HSKZSJ"/>
					<result property="jbpmsj" column="JBPMSJ"/>
					<result property="tssj" column="TSSJ"/>
					<result property="gdsj" column="GDSJ"/>
					<result property="ztfhsj" column="ZTFHSJ"/>
					<result property="xfjyjgTywysbm" column="XFJYJG_TYWYSBM"/>
					<result property="xzqhdm" column="XZQHDM"/>
					<result property="jzjglxdm" column="JZJGLXDM"/>
					<result property="ywqkdm" column="YWQKDM"/>
					<result property="zhcsdm" column="ZHCSDM"/>
					<result property="rswdm" column="RSWDM"/>
					<result property="bkrs" column="BKRS"/>
					<result property="rysw" column="RYSW"/>
					<result property="cperson" column="cperson"/>
					<result property="cdate" column="cdate"/>
					<result property="status" column="status"/>
			</resultMap>


	<select id="selectPageVo" resultType="com.smart119.webapi.domain.JbxxDO">
		SELECT distinct
		(SELECT COUNT(*)  FROM (SELECT
		count(*)
		FROM
		jqxx_jbxx ,
		jqxx_jqcjdp,
		jqxx_jqcjdp_dz
		where 1=1
		AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '1'
		AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
		AND jqxx_jbxx. STATUS = '0'
		AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
		AND jqxx_jqcjdp. STATUS = '0'
		AND jqxx_jqcjdp_dz.`status` = '0'
		AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
		<if test="startDate != null and startDate != ''">
			and cdate &gt;= #{startDate}
		</if>
		<if test="endDate != null and endDate != ''">
			and cdate &lt;= #{endDate}
		</if>
		group by jqxx_jbxx.JQ_TYWYSBM) B) as count,
		'火灾救援' AS mc,
		CONCAT(
		CAST(
		round(
		(
		(SELECT COUNT(*)  FROM (SELECT
		count(*)
		FROM
		jqxx_jbxx ,
		jqxx_jqcjdp,
		jqxx_jqcjdp_dz
		where 1=1
		AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '1'
		AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
		AND jqxx_jbxx. STATUS = '0'
		AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
		AND jqxx_jqcjdp. STATUS = '0'
		AND jqxx_jqcjdp_dz.`status` = '0'
		AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
		<if test="startDate != null and startDate != ''">
			and cdate &gt;= #{startDate}
		</if>
		<if test="endDate != null and endDate != ''">
			and cdate &lt;= #{endDate}
		</if>
		group by jqxx_jbxx.JQ_TYWYSBM) B) / (
		select COUNT(*)  FROM (SELECT
		count(*)
		FROM
		jqxx_jbxx ,
		jqxx_jqcjdp,
		jqxx_jqcjdp_dz
		where 1=1
		AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
		AND jqxx_jbxx. STATUS = '0'
		AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
		AND jqxx_jqcjdp. STATUS = '0'
		AND jqxx_jqcjdp_dz.`status` = '0'
		AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}

		<if test="startDate != null and startDate != ''">
			and cdate &gt;= #{startDate}
		</if>
		<if test="endDate != null and endDate != ''">
			and cdate &lt;= #{endDate}
		</if>
		group by jqxx_jbxx.JQ_TYWYSBM )A
		)
		) * 100,
		3
		) AS CHAR
		),
		'%'
		) AS percentage
		FROM
		jqxx_jqcjdp_dz C
		WHERE
		C. STATUS = '0'
		AND C.XFJYJG_TYWYSBM =  #{xfjyjgTywysbm}
		UNION ALL
		SELECT distinct
		(SELECT COUNT(*)  FROM (SELECT
		count(*)
		FROM
		jqxx_jbxx ,
		jqxx_jqcjdp,
		jqxx_jqcjdp_dz
		where 1=1
		AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '2'
		AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
		AND jqxx_jbxx. STATUS = '0'
		AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
		AND jqxx_jqcjdp. STATUS = '0'
		AND jqxx_jqcjdp_dz.`status` = '0'
		AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
		<if test="startDate != null and startDate != ''">
			and cdate &gt;= #{startDate}
		</if>
		<if test="endDate != null and endDate != ''">
			and cdate &lt;= #{endDate}
		</if>
		group by jqxx_jbxx.JQ_TYWYSBM) B) as count,
		'抢险救援' AS mc,
		CONCAT(
		CAST(
		round(
		(
		(SELECT COUNT(*)  FROM (SELECT
		count(*)
		FROM
		jqxx_jbxx ,
		jqxx_jqcjdp,
		jqxx_jqcjdp_dz
		where 1=1
		AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '2'
		AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
		AND jqxx_jbxx. STATUS = '0'
		AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
		AND jqxx_jqcjdp. STATUS = '0'
		AND jqxx_jqcjdp_dz.`status` = '0'
		AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
		<if test="startDate != null and startDate != ''">
			and cdate &gt;= #{startDate}
		</if>
		<if test="endDate != null and endDate != ''">
			and cdate &lt;= #{endDate}
		</if>
		group by jqxx_jbxx.JQ_TYWYSBM) B) / (
		select COUNT(*)  FROM (SELECT
		count(*)
		FROM
		jqxx_jbxx ,
		jqxx_jqcjdp,
		jqxx_jqcjdp_dz
		where 1=1
		AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
		AND jqxx_jbxx. STATUS = '0'
		AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
		AND jqxx_jqcjdp. STATUS = '0'
		AND jqxx_jqcjdp_dz.`status` = '0'
		AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}

		<if test="startDate != null and startDate != ''">
			and cdate &gt;= #{startDate}
		</if>
		<if test="endDate != null and endDate != ''">
			and cdate &lt;= #{endDate}
		</if>
		group by jqxx_jbxx.JQ_TYWYSBM )A
		)
		) * 100,
		3
		) AS CHAR
		),
		'%'
		) AS percentage
		FROM
		jqxx_jqcjdp_dz C
		WHERE
		C. STATUS = '0'
		AND C.XFJYJG_TYWYSBM =  #{xfjyjgTywysbm}
		UNION ALL
		SELECT distinct
		(SELECT COUNT(*)  FROM (SELECT
		count(*)
		FROM
		jqxx_jbxx ,
		jqxx_jqcjdp,
		jqxx_jqcjdp_dz
		where 1=1
		AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '3'
		AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
		AND jqxx_jbxx. STATUS = '0'
		AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
		AND jqxx_jqcjdp. STATUS = '0'
		AND jqxx_jqcjdp_dz.`status` = '0'
		AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
		<if test="startDate != null and startDate != ''">
			and cdate &gt;= #{startDate}
		</if>
		<if test="endDate != null and endDate != ''">
			and cdate &lt;= #{endDate}
		</if>
		group by jqxx_jbxx.JQ_TYWYSBM) B) as count,
		'反恐排爆' AS mc,
		CONCAT(
		CAST(
		round(
		(
		(SELECT COUNT(*)  FROM (SELECT
		count(*)
		FROM
		jqxx_jbxx ,
		jqxx_jqcjdp,
		jqxx_jqcjdp_dz
		where 1=1
		AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '3'
		AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
		AND jqxx_jbxx. STATUS = '0'
		AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
		AND jqxx_jqcjdp. STATUS = '0'
		AND jqxx_jqcjdp_dz.`status` = '0'
		AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
		<if test="startDate != null and startDate != ''">
			and cdate &gt;= #{startDate}
		</if>
		<if test="endDate != null and endDate != ''">
			and cdate &lt;= #{endDate}
		</if>
		group by jqxx_jbxx.JQ_TYWYSBM) B) / (
		select COUNT(*)  FROM (SELECT
		count(*)
		FROM
		jqxx_jbxx ,
		jqxx_jqcjdp,
		jqxx_jqcjdp_dz
		where 1=1
		AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
		AND jqxx_jbxx. STATUS = '0'
		AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
		AND jqxx_jqcjdp. STATUS = '0'
		AND jqxx_jqcjdp_dz.`status` = '0'
		AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}

		<if test="startDate != null and startDate != ''">
			and cdate &gt;= #{startDate}
		</if>
		<if test="endDate != null and endDate != ''">
			and cdate &lt;= #{endDate}
		</if>
		group by jqxx_jbxx.JQ_TYWYSBM )A
		)
		) * 100,
		3
		) AS CHAR
		),
		'%'
		) AS percentage
		FROM
		jqxx_jqcjdp_dz C
		WHERE
		C. STATUS = '0'
		AND C.XFJYJG_TYWYSBM =  #{xfjyjgTywysbm}
		UNION ALL
		SELECT distinct
		(SELECT COUNT(*)  FROM (SELECT
		count(*)
		FROM
		jqxx_jbxx ,
		jqxx_jqcjdp,
		jqxx_jqcjdp_dz
		where 1=1
		AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '4'
		AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
		AND jqxx_jbxx. STATUS = '0'
		AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
		AND jqxx_jqcjdp. STATUS = '0'
		AND jqxx_jqcjdp_dz.`status` = '0'
		AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
		<if test="startDate != null and startDate != ''">
			and cdate &gt;= #{startDate}
		</if>
		<if test="endDate != null and endDate != ''">
			and cdate &lt;= #{endDate}
		</if>
		group by jqxx_jbxx.JQ_TYWYSBM) B) as count,
		'公务执勤' AS mc,
		CONCAT(
		CAST(
		round(
		(
		(SELECT COUNT(*)  FROM (SELECT
		count(*)
		FROM
		jqxx_jbxx ,
		jqxx_jqcjdp,
		jqxx_jqcjdp_dz
		where 1=1
		AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '4'
		AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
		AND jqxx_jbxx. STATUS = '0'
		AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
		AND jqxx_jqcjdp. STATUS = '0'
		AND jqxx_jqcjdp_dz.`status` = '0'
		AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
		<if test="startDate != null and startDate != ''">
			and cdate &gt;= #{startDate}
		</if>
		<if test="endDate != null and endDate != ''">
			and cdate &lt;= #{endDate}
		</if>
		group by jqxx_jbxx.JQ_TYWYSBM) B) / (
		select COUNT(*)  FROM (SELECT
		count(*)
		FROM
		jqxx_jbxx ,
		jqxx_jqcjdp,
		jqxx_jqcjdp_dz
		where 1=1
		AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
		AND jqxx_jbxx. STATUS = '0'
		AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
		AND jqxx_jqcjdp. STATUS = '0'
		AND jqxx_jqcjdp_dz.`status` = '0'
		AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}

		<if test="startDate != null and startDate != ''">
			and cdate &gt;= #{startDate}
		</if>
		<if test="endDate != null and endDate != ''">
			and cdate &lt;= #{endDate}
		</if>
		group by jqxx_jbxx.JQ_TYWYSBM )A
		)
		) * 100,
		3
		) AS CHAR
		),
		'%'
		) AS percentage
		FROM
		jqxx_jqcjdp_dz C
		WHERE
		C. STATUS = '0'
		AND C.XFJYJG_TYWYSBM =  #{xfjyjgTywysbm}
		UNION ALL
		SELECT distinct
		(SELECT COUNT(*)  FROM (SELECT
		count(*)
		FROM
		jqxx_jbxx ,
		jqxx_jqcjdp,
		jqxx_jqcjdp_dz
		where 1=1
		AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '5'
		AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
		AND jqxx_jbxx. STATUS = '0'
		AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
		AND jqxx_jqcjdp. STATUS = '0'
		AND jqxx_jqcjdp_dz.`status` = '0'
		AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
		<if test="startDate != null and startDate != ''">
			and cdate &gt;= #{startDate}
		</if>
		<if test="endDate != null and endDate != ''">
			and cdate &lt;= #{endDate}
		</if>
		group by jqxx_jbxx.JQ_TYWYSBM) B) as count,
		'社会救助' AS mc,
		CONCAT(
		CAST(
		round(
		(
		(SELECT COUNT(*)  FROM (SELECT
		count(*)
		FROM
		jqxx_jbxx ,
		jqxx_jqcjdp,
		jqxx_jqcjdp_dz
		where 1=1
		AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '5'
		AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
		AND jqxx_jbxx. STATUS = '0'
		AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
		AND jqxx_jqcjdp. STATUS = '0'
		AND jqxx_jqcjdp_dz.`status` = '0'
		AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
		<if test="startDate != null and startDate != ''">
			and cdate &gt;= #{startDate}
		</if>
		<if test="endDate != null and endDate != ''">
			and cdate &lt;= #{endDate}
		</if>
		group by jqxx_jbxx.JQ_TYWYSBM) B) / (
		select COUNT(*)  FROM (SELECT
		count(*)
		FROM
		jqxx_jbxx ,
		jqxx_jqcjdp,
		jqxx_jqcjdp_dz
		where 1=1
		AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
		AND jqxx_jbxx. STATUS = '0'
		AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
		AND jqxx_jqcjdp. STATUS = '0'
		AND jqxx_jqcjdp_dz.`status` = '0'
		AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
		<if test="startDate != null and startDate != ''">
			and cdate &gt;= #{startDate}
		</if>
		<if test="endDate != null and endDate != ''">
			and cdate &lt;= #{endDate}
		</if>
		group by jqxx_jbxx.JQ_TYWYSBM )A
		)
		) * 100,
		3
		) AS CHAR
		),
		'%'
		) AS percentage
		FROM
		jqxx_jqcjdp_dz C
		WHERE
		C. STATUS = '0'
		AND C.XFJYJG_TYWYSBM =  #{xfjyjgTywysbm}
		UNION ALL
		SELECT distinct
		(SELECT COUNT(*)  FROM (SELECT
		count(*)
		FROM
		jqxx_jbxx ,
		jqxx_jqcjdp,
		jqxx_jqcjdp_dz
		where 1=1
		AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '6'
		AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
		AND jqxx_jbxx. STATUS = '0'
		AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
		AND jqxx_jqcjdp. STATUS = '0'
		AND jqxx_jqcjdp_dz.`status` = '0'
		AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
		<if test="startDate != null and startDate != ''">
			and cdate &gt;= #{startDate}
		</if>
		<if test="endDate != null and endDate != ''">
			and cdate &lt;= #{endDate}
		</if>
		group by jqxx_jbxx.JQ_TYWYSBM) B) as count,
		'其他出动' AS mc,
		CONCAT(
		CAST(
		round(
		(
		(SELECT COUNT(*)  FROM (SELECT
		count(*)
		FROM
		jqxx_jbxx ,
		jqxx_jqcjdp,
		jqxx_jqcjdp_dz
		where 1=1
		AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '6'
		AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
		AND jqxx_jbxx. STATUS = '0'
		AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
		AND jqxx_jqcjdp. STATUS = '0'
		AND jqxx_jqcjdp_dz.`status` = '0'
		AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
		<if test="startDate != null and startDate != ''">
			and cdate &gt;= #{startDate}
		</if>
		<if test="endDate != null and endDate != ''">
			and cdate &lt;= #{endDate}
		</if>
		group by jqxx_jbxx.JQ_TYWYSBM) B) / (
		select COUNT(*)  FROM (SELECT
		count(*)
		FROM
		jqxx_jbxx ,
		jqxx_jqcjdp,
		jqxx_jqcjdp_dz
		where 1=1
		AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
		AND jqxx_jbxx. STATUS = '0'
		AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
		AND jqxx_jqcjdp. STATUS = '0'
		AND jqxx_jqcjdp_dz.`status` = '0'
		AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}

		<if test="startDate != null and startDate != ''">
			and cdate &gt;= #{startDate}
		</if>
		<if test="endDate != null and endDate != ''">
			and cdate &lt;= #{endDate}
		</if>
		group by jqxx_jbxx.JQ_TYWYSBM )A
		)
		) * 100,
		3
		) AS CHAR
		),
		'%'
		) AS percentage
		FROM
		jqxx_jqcjdp_dz C
		WHERE
		C. STATUS = '0'
		AND C.XFJYJG_TYWYSBM =  #{xfjyjgTywysbm}
	</select>


</mapper>