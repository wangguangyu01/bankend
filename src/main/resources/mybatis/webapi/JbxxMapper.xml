<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.smart119.webapi.dao.JbxxDao">

    <select id="get" resultType="com.smart119.webapi.domain.JbxxDO">
		select `JQ_TYWYSBM`,`BJ_TYWYSBM`,`MC`,`DDMC`,`JQFLYDM`,`JQDJDM`,`JQZT_LBDM`,`JQZT_RQSJ`,`JQDX_TYWYSBM`,`JQDX_MC`,`JQDX_JYQK`,`JQ_JYQK`,`JQBSLBDM`,`LC`,`DQJD`,`DQWD`,`BJRXM`,`BJDH`,`BJFSLBDM`,`BJSJ`,`LASJ`,`JASJ`,`JSMLSJ`,`CDSJ`,`DCSJ`,`ZDZKSJ`,`CSSJ`,`HSKZSJ`,`JBPMSJ`,`TSSJ`,`GDSJ`,`ZTFHSJ`,`XFJYJG_TYWYSBM`,`XZQHDM`,`JZJGLXDM`,`YWQKDM`,`ZHCSDM`,`RSWDM`,`BKRS`,`RYSW`,`cperson`,`cdate`,`status` from jqxx_jbxx where JQ_TYWYSBM = #{value}
	</select>

    <select id="list" resultType="com.smart119.webapi.domain.JbxxDO">
        SELECT
        i.`JQ_TYWYSBM`,
        i.`BJ_TYWYSBM`,
        i.`MC`,
        i.`DDMC`,
        (
        SELECT
        d1.`name`
        FROM
        sys_dict d1
        WHERE
        d1.type = 'JQFLYDM'
        AND d1.`value` = CONCAT( LEFT ( i.JQFLYDM, 1 ), '0000' )) AS JQFLYDM,
        GROUP_CONCAT(DISTINCT d.DWJC ) AS DWJC,
        GROUP_CONCAT(DISTINCT d.XFJYJG_TYWYSBM ) AS xfjgid,
        dj.`name` AS JQDJDM,
        zt.`name` AS JQZT_LBDM,
        i.`JQZT_RQSJ`,
        i.`JQDX_TYWYSBM`,
        i.`JQDX_MC`,
        i.`JQDX_JYQK`,
        i.`JQ_JYQK`,
        i.`JQBSLBDM`,
        i.`LC`,
        i.`DQJD`,
        i.`DQWD`,
        i.`BJRXM`,
        i.`BJDH`,
        i.`BJFSLBDM`,
        i.`BJSJ`,
        i.`LASJ`,
        i.`JASJ`,
        i.`JSMLSJ`,
        i.`CDSJ`,
        i.`DCSJ`,
        i.`ZDZKSJ`,
        i.`CSSJ`,
        i.`HSKZSJ`,
        i.`JBPMSJ`,
        i.`TSSJ`,
        i.`GDSJ`,
        i.`ZTFHSJ`,
        i.`XFJYJG_TYWYSBM`,
        i.`XZQHDM`,
        i.`JZJGLXDM`,
        i.`YWQKDM`,
        i.`ZHCSDM`,
        i.`RSWDM`,
        i.`BKRS`,
        i.`RYSW`,
        i.`cperson`,
        i.`cdate`,
        i.`status`
        FROM
        jqxx_jbxx i
        LEFT JOIN sys_dict dj ON dj.`value` = i.JQDJDM
        AND dj.type = 'JQDJDM' -- 警情等级
        LEFT JOIN sys_dict zt ON zt.`value` = i.JQZT_LBDM
        AND zt.type = 'JQZTLBDM' -- 警情状态
        LEFT JOIN jqxx_jqcjdp dp ON dp.JQ_TYWYSBM = i.JQ_TYWYSBM
        LEFT JOIN jqxx_jqcjdp_dz dz on dz.DP_TYWYSBM = dp.JQCJDP_TYWYSBM
        LEFT JOIN sys_dept d on dz.XFJYJG_TYWYSBM=d.XFJYJG_TYWYSBM
        <where>
            i.JQZT_LBDM!='1'
            <if test="jqTywysbm != null and jqTywysbm != ''">and i.JQ_TYWYSBM = #{jqTywysbm}</if>
            <if test="bjTywysbm != null and bjTywysbm != ''">and i.BJ_TYWYSBM = #{bjTywysbm}</if>
            <if test="mc != null and mc != ''">and i.MC = #{mc}</if>
            <if test="ddmc != null and ddmc != ''">and i.DDMC = #{ddmc}</if>
            <if test="jqflydm != null and jqflydm != ''"> and  LEFT ( i.`JQFLYDM`, 1 ) = LEFT ( #{jqflydm}, 1 )  </if>
            <if test="jqdjdm != null and jqdjdm != ''">and i.JQDJDM = #{jqdjdm}</if>
            <if test="jqztLbdm != null and jqztLbdm != ''">and i.JQZT_LBDM in( ${jqztLbdm})</if>
            <if test="jqztRqsj != null and jqztRqsj != ''">and ixfcl.JQZT_RQSJ = #{jqztRqsj}</if>
            <if test="jqdxTywysbm != null and jqdxTywysbm != ''">and i.JQDX_TYWYSBM = #{jqdxTywysbm}</if>
            <if test="jqdxMc != null and jqdxMc != ''">and i.JQDX_MC = #{jqdxMc}</if>
            <if test="jqdxJyqk != null and jqdxJyqk != ''">and i.JQDX_JYQK = #{jqdxJyqk}</if>
            <if test="jqJyqk != null and jqJyqk != ''">and i.JQ_JYQK like '%${jqJyqk}%'</if>
            <if test="jqbslbdm != null and jqbslbdm != ''">and i.JQBSLBDM = #{jqbslbdm}</if>
            <if test="lc != null and lc != ''">and i.LC = #{lc}</if>
            <if test="dqjd != null and dqjd != ''">and i.DQJD = #{dqjd}</if>
            <if test="dqwd != null and dqwd != ''">and i.DQWD = #{dqwd}</if>
            <if test="bjrxm != null and bjrxm != ''">and i.BJRXM = #{bjrxm}</if>
            <if test="bjdh != null and bjdh != ''">and i.BJDH = #{bjdh}</if>
            <if test="bjfslbdm != null and bjfslbdm != ''">and i.BJFSLBDM = #{bjfslbdm}</if>
            <if test="bjsj != null and bjsj != ''">and i.BJSJ = #{bjsj}</if>
            <if test="lasj != null and lasj != ''">and i.LASJ = #{lasj}</if>
            <if test="jasj != null and jasj != ''">and i.JASJ = #{jasj}</if>
            <if test="jsmlsj != null and jsmlsj != ''">and i.JSMLSJ = #{jsmlsj}</if>
            <if test="cdsj != null and cdsj != ''">and i.CDSJ = #{cdsj}</if>
            <if test="dcsj != null and dcsj != ''">and i.DCSJ = #{dcsj}</if>
            <if test="zdzksj != null and zdzksj != ''">and i.ZDZKSJ = #{zdzksj}</if>
            <if test="cssj != null and cssj != ''">and i.CSSJ = #{cssj}</if>
            <if test="hskzsj != null and hskzsj != ''">and i.HSKZSJ = #{hskzsj}</if>
            <if test="jbpmsj != null and jbpmsj != ''">and i.JBPMSJ = #{jbpmsj}</if>
            <if test="tssj != null and tssj != ''">and i.TSSJ = #{tssj}</if>
            <if test="gdsj != null and gdsj != ''">and i.GDSJ = #{gdsj}</if>
            <if test="ztfhsj != null and ztfhsj != ''">and i.ZTFHSJ = #{ztfhsj}</if>
            <if test="xfjyjgTywysbm != null and xfjyjgTywysbm != ''">and i.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}</if>
            <if test="xzqhdm != null and xzqhdm != ''">and i.XZQHDM = #{xzqhdm}</if>
            <if test="jzjglxdm != null and jzjglxdm != ''">and i.JZJGLXDM = #{jzjglxdm}</if>
            <if test="ywqkdm != null and ywqkdm != ''">and i.YWQKDM = #{ywqkdm}</if>
            <if test="zhcsdm != null and zhcsdm != ''">and i.ZHCSDM = #{zhcsdm}</if>
            <if test="rswdm != null and rswdm != ''">and i.RSWDM = #{rswdm}</if>
            <if test="bkrs != null and bkrs != ''">and i.BKRS = #{bkrs}</if>
            <if test="rysw != null and rysw != ''">and i.RYSW = #{rysw}</if>
            <if test="cperson != null and cperson != ''">and i.cperson = #{cperson}</if>
            <if test="cdate != null and cdate != ''">and i.cdate = #{cdate}</if>
            <if test="status != null and status != ''">and i.status = #{status}</if>
            <if test="jlrTywysbm != null and jlrTywysbm != ''">and dz.XFJYJG_TYWYSBM = #{jlrTywysbm}</if>
        </where>
        GROUP BY
        i.JQ_TYWYSBM
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by i.cdate desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>


    <select id="listByDate" resultType="com.smart119.webapi.domain.JbxxDO">
        SELECT
        i.`JQ_TYWYSBM`,
        i.`BJ_TYWYSBM`,
        i.`MC`,
        i.`DDMC`,
        (
        SELECT
        d1.`name`
        FROM
        sys_dict d1
        WHERE
        d1.type = 'JQFLYDM'
        AND d1.`value` = CONCAT( LEFT ( i.JQFLYDM, 1 ), '0000' )) AS JQFLYDM,
        GROUP_CONCAT(DISTINCT d.DWJC ) AS DWJC,
        GROUP_CONCAT(DISTINCT d.XFJYJG_TYWYSBM ) AS xfjgid,
        dj.`name` AS JQDJDM,
        zt.`name` AS JQZT_LBDM,
        i.`JQZT_RQSJ`,
        i.`JQDX_TYWYSBM`,
        i.`JQDX_MC`,
        i.`JQDX_JYQK`,
        i.`JQ_JYQK`,
        i.`JQBSLBDM`,
        i.`LC`,
        i.`DQJD`,
        i.`DQWD`,
        i.`BJRXM`,
        i.`BJDH`,
        i.`BJFSLBDM`,
        i.`BJSJ`,
        i.`LASJ`,
        i.`JASJ`,
        i.`JSMLSJ`,
        i.`CDSJ`,
        i.`DCSJ`,
        i.`ZDZKSJ`,
        i.`CSSJ`,
        i.`HSKZSJ`,
        i.`JBPMSJ`,
        i.`TSSJ`,
        i.`GDSJ`,
        i.`ZTFHSJ`,
        i.`XFJYJG_TYWYSBM`,
        i.`XZQHDM`,
        i.`JZJGLXDM`,
        i.`YWQKDM`,
        i.`ZHCSDM`,
        i.`RSWDM`,
        i.`BKRS`,
        i.`RYSW`,
        i.`cperson`,
        i.`cdate`,
        i.`status`
        FROM
        jqxx_jbxx i
        LEFT JOIN sys_dict dj ON dj.`value` = i.JQDJDM
        AND dj.type = 'JQDJDM' -- 警情等级
        LEFT JOIN sys_dict zt ON zt.`value` = i.JQZT_LBDM
        AND zt.type = 'JQZTLBDM' -- 警情状态
        LEFT JOIN jqxx_jqcjdp dp ON dp.JQ_TYWYSBM = i.JQ_TYWYSBM
        LEFT JOIN jqxx_jqcjdp_dz dz on dz.DP_TYWYSBM = dp.JQCJDP_TYWYSBM
        LEFT JOIN sys_dept d on dz.XFJYJG_TYWYSBM=d.XFJYJG_TYWYSBM
        WHERE i.cdate BETWEEN DATE_FORMAT(CURDATE(),'%Y-%m-%d %H:%i:%s') AND NOW()
        GROUP BY
        i.JQ_TYWYSBM
    </select>

    <select id="count" resultType="int">
        select count(DISTINCT i.JQ_TYWYSBM) as count from jqxx_jbxx i
        LEFT JOIN jqxx_jqcjdp dp ON dp.JQ_TYWYSBM = i.JQ_TYWYSBM
        LEFT JOIN jqxx_jqcjdp_dz dz on dz.DP_TYWYSBM = dp.JQCJDP_TYWYSBM
        LEFT JOIN sys_dept d on dz.XFJYJG_TYWYSBM=d.XFJYJG_TYWYSBM
        <where>
            i.JQZT_LBDM!='1'
            <if test="jqTywysbm != null and jqTywysbm != ''">and i.JQ_TYWYSBM = #{jqTywysbm}</if>
            <if test="bjTywysbm != null and bjTywysbm != ''">and i.BJ_TYWYSBM = #{bjTywysbm}</if>
            <if test="mc != null and mc != ''">and i.MC = #{mc}</if>
            <if test="ddmc != null and ddmc != ''">and i.DDMC = #{ddmc}</if>
            <if test="jqflydm != null and jqflydm != ''"> and  LEFT ( i.`JQFLYDM`, 1 ) = LEFT ( #{jqflydm}, 1 )  </if>
            <if test="jqdjdm != null and jqdjdm != ''">and i.JQDJDM = #{jqdjdm}</if>
            <if test="jqztLbdm != null and jqztLbdm != ''">and i.JQZT_LBDM in( ${jqztLbdm})</if>
            <if test="jqztRqsj != null and jqztRqsj != ''">and i.JQZT_RQSJ = #{jqztRqsj}</if>
            <if test="jqdxTywysbm != null and jqdxTywysbm != ''">and i.JQDX_TYWYSBM = #{jqdxTywysbm}</if>
            <if test="jqdxMc != null and jqdxMc != ''">and i.JQDX_MC = #{jqdxMc}</if>
            <if test="jqdxJyqk != null and jqdxJyqk != ''">and i.JQDX_JYQK = #{jqdxJyqk}</if>
            <if test="jqJyqk != null and jqJyqk != ''">and i.JQ_JYQK like '%${jqJyqk}%'</if>
            <if test="jqbslbdm != null and jqbslbdm != ''">and i.JQBSLBDM = #{jqbslbdm}</if>
            <if test="lc != null and lc != ''">and i.LC = #{lc}</if>
            <if test="dqjd != null and dqjd != ''">and i.DQJD = #{dqjd}</if>
            <if test="dqwd != null and dqwd != ''">and i.DQWD = #{dqwd}</if>
            <if test="bjrxm != null and bjrxm != ''">and i.BJRXM = #{bjrxm}</if>
            <if test="bjdh != null and bjdh != ''">and i.BJDH = #{bjdh}</if>
            <if test="bjfslbdm != null and bjfslbdm != ''">and i.BJFSLBDM = #{bjfslbdm}</if>
            <if test="bjsj != null and bjsj != ''">and i.BJSJ = #{bjsj}</if>
            <if test="lasj != null and lasj != ''">and i.LASJ = #{lasj}</if>
            <if test="jasj != null and jasj != ''">and i.JASJ = #{jasj}</if>
            <if test="jsmlsj != null and jsmlsj != ''">and i.JSMLSJ = #{jsmlsj}</if>
            <if test="cdsj != null and cdsj != ''">and i.CDSJ = #{cdsj}</if>
            <if test="dcsj != null and dcsj != ''">and i.DCSJ = #{dcsj}</if>
            <if test="zdzksj != null and zdzksj != ''">and i.ZDZKSJ = #{zdzksj}</if>
            <if test="cssj != null and cssj != ''">and i.CSSJ = #{cssj}</if>
            <if test="hskzsj != null and hskzsj != ''">and i.HSKZSJ = #{hskzsj}</if>
            <if test="jbpmsj != null and jbpmsj != ''">and i.JBPMSJ = #{jbpmsj}</if>
            <if test="tssj != null and tssj != ''">and i.TSSJ = #{tssj}</if>
            <if test="gdsj != null and gdsj != ''">and i.GDSJ = #{gdsj}</if>
            <if test="ztfhsj != null and ztfhsj != ''">and i.ZTFHSJ = #{ztfhsj}</if>
            <if test="xfjyjgTywysbm != null and xfjyjgTywysbm != ''">and i.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}</if>
            <if test="xzqhdm != null and xzqhdm != ''">and i.XZQHDM = #{xzqhdm}</if>
            <if test="jzjglxdm != null and jzjglxdm != ''">and i.JZJGLXDM = #{jzjglxdm}</if>
            <if test="ywqkdm != null and ywqkdm != ''">and i.YWQKDM = #{ywqkdm}</if>
            <if test="zhcsdm != null and zhcsdm != ''">and i.ZHCSDM = #{zhcsdm}</if>
            <if test="rswdm != null and rswdm != ''">and i.RSWDM = #{rswdm}</if>
            <if test="bkrs != null and bkrs != ''">and i.BKRS = #{bkrs}</if>
            <if test="rysw != null and rysw != ''">and i.RYSW = #{rysw}</if>
            <if test="cperson != null and cperson != ''">and i.cperson = #{cperson}</if>
            <if test="cdate != null and cdate != ''">and i.cdate = #{cdate}</if>
            <if test="status != null and status != ''">and i.status = #{status}</if>
            <if test="jlrTywysbm != null and jlrTywysbm != ''">and dz.XFJYJG_TYWYSBM = #{jlrTywysbm}</if>
        </where>
    </select>
    <select id="dzjqlist" resultType="com.smart119.webapi.domain.JbxxDO">
        SELECT
        i.`JQ_TYWYSBM`,
        i.`BJ_TYWYSBM`,
        i.`MC`,
        i.`DDMC`,
        (
        SELECT
        d1.`name`
        FROM
        sys_dict d1
        WHERE
        d1.type = 'JQFLYDM'
        AND d1.`value` = CONCAT( LEFT ( i.JQFLYDM, 1 ), '0000' )) AS JQFLYDM,
        dj.`name` AS JQDJDM,
        zt.`name` AS JQZT_LBDM,
        i.`JQZT_RQSJ`,
        i.`JQDX_TYWYSBM`,
        i.`JQDX_MC`,
        i.`JQDX_JYQK`,
        i.`JQ_JYQK`,
        i.`JQBSLBDM`,
        i.`LC`,
        i.`DQJD`,
        i.`DQWD`,
        i.`BJRXM`,
        i.`BJDH`,
        i.`BJFSLBDM`,
        i.`BJSJ`,
        i.`LASJ`,
        i.`JASJ`,
        i.`JSMLSJ`,
        i.`CDSJ`,
        i.`DCSJ`,
        i.`ZDZKSJ`,
        i.`CSSJ`,
        i.`HSKZSJ`,
        i.`JBPMSJ`,
        i.`TSSJ`,
        i.`GDSJ`,
        i.`ZTFHSJ`,
        dz.`XFJYJG_TYWYSBM`,
        i.`XZQHDM`,
        i.`JZJGLXDM`,
        i.`YWQKDM`,
        i.`ZHCSDM`,
        i.`RSWDM`,
        i.`BKRS`,
        i.`RYSW`,
        i.`cperson`,
        i.`cdate`,
        i.`status`
        from jqxx_jbxx i
        LEFT JOIN sys_dict dj ON dj.`value` = i.JQDJDM
        AND dj.type = 'JQDJDM' -- 警情等级
        LEFT JOIN sys_dict zt ON zt.`value` = i.JQZT_LBDM
        AND zt.type = 'JQZTLBDM' -- 警情状态
        LEFT JOIN jqxx_jqcjdp dp on i.JQ_TYWYSBM=dp.JQ_TYWYSBM
        LEFT JOIN jqxx_jqcjdp_dz dz on dp.JQCJDP_TYWYSBM=dz.DP_TYWYSBM
        LEFT JOIN sys_dept d ON dz.XFJYJG_TYWYSBM = d.dept_id
        <where>
            i.JQZT_LBDM!='1'
            <if test="jqTywysbm != null and jqTywysbm != ''">and i.JQ_TYWYSBM = #{jqTywysbm}</if>
            <if test="bjTywysbm != null and bjTywysbm != ''">and i.BJ_TYWYSBM = #{bjTywysbm}</if>
            <if test="mc != null and mc != ''">and i.MC = #{mc}</if>
            <if test="ddmc != null and ddmc != ''">and i.DDMC = #{ddmc}</if>
            <if test="jqflydm != null and jqflydm != ''"> and  LEFT ( i.`JQFLYDM`, 1 ) = LEFT ( #{jqflydm}, 1 )  </if>
            <if test="jqdjdm != null and jqdjdm != ''">and i.JQDJDM = #{jqdjdm}</if>
            <if test="jqztLbdm != null and jqztLbdm != ''">and i.JQZT_LBDM in( ${jqztLbdm})</if>
            <if test="jqztRqsj != null and jqztRqsj != ''">and i.JQZT_RQSJ = #{jqztRqsj}</if>
            <if test="jqdxTywysbm != null and jqdxTywysbm != ''">and i.JQDX_TYWYSBM = #{jqdxTywysbm}</if>
            <if test="jqdxMc != null and jqdxMc != ''">and i.JQDX_MC = #{jqdxMc}</if>
            <if test="jqdxJyqk != null and jqdxJyqk != ''">and i.JQDX_JYQK = #{jqdxJyqk}</if>
            <if test="jqJyqk != null and jqJyqk != ''">and i.JQ_JYQK like '%${jqJyqk}%'</if>
            <if test="jqbslbdm != null and jqbslbdm != ''">and i.JQBSLBDM = #{jqbslbdm}</if>
            <if test="lc != null and lc != ''">and i.LC = #{lc}</if>
            <if test="dqjd != null and dqjd != ''">and i.DQJD = #{dqjd}</if>
            <if test="dqwd != null and dqwd != ''">and i.DQWD = #{dqwd}</if>
            <if test="bjrxm != null and bjrxm != ''">and i.BJRXM = #{bjrxm}</if>
            <if test="bjdh != null and bjdh != ''">and i.BJDH = #{bjdh}</if>
            <if test="bjfslbdm != null and bjfslbdm != ''">and i.BJFSLBDM = #{bjfslbdm}</if>
            <if test="bjsj != null and bjsj != ''">and i.BJSJ = #{bjsj}</if>
            <if test="lasj != null and lasj != ''">and i.LASJ = #{lasj}</if>
            <if test="jasj != null and jasj != ''">and i.JASJ = #{jasj}</if>
            <if test="jsmlsj != null and jsmlsj != ''">and i.JSMLSJ = #{jsmlsj}</if>
            <if test="cdsj != null and cdsj != ''">and i.CDSJ = #{cdsj}</if>
            <if test="dcsj != null and dcsj != ''">and i.DCSJ = #{dcsj}</if>
            <if test="zdzksj != null and zdzksj != ''">and i.ZDZKSJ = #{zdzksj}</if>
            <if test="cssj != null and cssj != ''">and i.CSSJ = #{cssj}</if>
            <if test="hskzsj != null and hskzsj != ''">and i.HSKZSJ = #{hskzsj}</if>
            <if test="jbpmsj != null and jbpmsj != ''">and i.JBPMSJ = #{jbpmsj}</if>
            <if test="tssj != null and tssj != ''">and i.TSSJ = #{tssj}</if>
            <if test="gdsj != null and gdsj != ''">and i.GDSJ = #{gdsj}</if>
            <if test="ztfhsj != null and ztfhsj != ''">and i.ZTFHSJ = #{ztfhsj}</if>
            <if test="xfjyjgTywysbm != null and xfjyjgTywysbm != ''">and i.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}</if>
            <if test="xzqhdm != null and xzqhdm != ''">and i.XZQHDM = #{xzqhdm}</if>
            <if test="jzjglxdm != null and jzjglxdm != ''">and i.JZJGLXDM = #{jzjglxdm}</if>
            <if test="ywqkdm != null and ywqkdm != ''">and i.YWQKDM = #{ywqkdm}</if>
            <if test="zhcsdm != null and zhcsdm != ''">and i.ZHCSDM = #{zhcsdm}</if>
            <if test="rswdm != null and rswdm != ''">and i.RSWDM = #{rswdm}</if>
            <if test="bkrs != null and bkrs != ''">and i.BKRS = #{bkrs}</if>
            <if test="rysw != null and rysw != ''">and i.RYSW = #{rysw}</if>
            <if test="cperson != null and cperson != ''">and i.cperson = #{cperson}</if>
            <if test="cdate != null and cdate != ''">and i.cdate = #{cdate}</if>
            <if test="status != null and status != ''">and i.status = #{status}</if>
            <if test="jlrTywysbm != null and jlrTywysbm != ''">and dz.XFJYJG_TYWYSBM = #{jlrTywysbm}</if>
            <if test="dateStatus==1">and TO_DAYS(i.cdate) = TO_DAYS(NOW())   </if>
            <if test="dateStatus==2">and YEARWEEK(DATE_FORMAT(i.cdate,'%Y-%m-%d')) = YEARWEEK(NOW()) </if>
            <if test="dateStatus==3">and DATE_FORMAT(i.cdate,'%Y%m') = DATE_FORMAT(CURDATE(),'%Y%m') </if>

        </where>
        GROUP BY i.JQ_TYWYSBM
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
            <otherwise>
                order by i.cdate desc
            </otherwise>
        </choose>
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="dzjqcount" resultType="int">
        select count(DISTINCT JQ.JQ_TYWYSBM) as count from jqxx_jbxx jq
        LEFT JOIN sys_dict zt ON zt.`value` = jq.JQZT_LBDM
        AND zt.type = 'JQZTLBDM' -- 警情状态
        LEFT JOIN jqxx_jqcjdp dp on jq.JQ_TYWYSBM=dp.JQ_TYWYSBM
        LEFT JOIN jqxx_jqcjdp_dz dz on dp.JQCJDP_TYWYSBM=dz.DP_TYWYSBM
        <where>
            jq.JQZT_LBDM!='1'
            <if test="jqTywysbm != null and jqTywysbm != ''">and jq.JQ_TYWYSBM = #{jqTywysbm}</if>
            <if test="bjTywysbm != null and bjTywysbm != ''">and jq.BJ_TYWYSBM = #{bjTywysbm}</if>
            <if test="mc != null and mc != ''">and jq.MC = #{mc}</if>
            <if test="ddmc != null and ddmc != ''">and jq.DDMC = #{ddmc}</if>
            <if test="jqflydm != null and jqflydm != ''"> and  LEFT ( jq.`JQFLYDM`, 1 ) = LEFT ( #{jqflydm}, 1 )  </if>
            <if test="jqdjdm != null and jqdjdm != ''">and jq.JQDJDM = #{jqdjdm}</if>
            <if test="jqztLbdm != null and jqztLbdm != ''">and jq.JQZT_LBDM in( ${jqztLbdm})</if>
            <if test="jqztRqsj != null and jqztRqsj != ''">and jq.JQZT_RQSJ = #{jqztRqsj}</if>
            <if test="jqdxTywysbm != null and jqdxTywysbm != ''">and jq.JQDX_TYWYSBM = #{jqdxTywysbm}</if>
            <if test="jqdxMc != null and jqdxMc != ''">and jq.JQDX_MC = #{jqdxMc}</if>
            <if test="jqdxJyqk != null and jqdxJyqk != ''">and jq.JQDX_JYQK = #{jqdxJyqk}</if>
            <if test="jqJyqk != null and jqJyqk != ''">and jq.JQ_JYQK = #{jqJyqk}</if>
            <if test="jqbslbdm != null and jqbslbdm != ''">and jq.JQBSLBDM = #{jqbslbdm}</if>
            <if test="lc != null and lc != ''">and jq.LC = #{lc}</if>
            <if test="dqjd != null and dqjd != ''">and jq.DQJD = #{dqjd}</if>
            <if test="dqwd != null and dqwd != ''">and jq.DQWD = #{dqwd}</if>
            <if test="bjrxm != null and bjrxm != ''">and jq.BJRXM = #{bjrxm}</if>
            <if test="bjdh != null and bjdh != ''">and jq.BJDH = #{bjdh}</if>
            <if test="bjfslbdm != null and bjfslbdm != ''">and jq.BJFSLBDM = #{bjfslbdm}</if>
            <if test="bjsj != null and bjsj != ''">and jq.BJSJ = #{bjsj}</if>
            <if test="lasj != null and lasj != ''">and jq.LASJ = #{lasj}</if>
            <if test="jasj != null and jasj != ''">and jq.JASJ = #{jasj}</if>
            <if test="jsmlsj != null and jsmlsj != ''">and jq.JSMLSJ = #{jsmlsj}</if>
            <if test="cdsj != null and cdsj != ''">and jq.CDSJ = #{cdsj}</if>
            <if test="dcsj != null and dcsj != ''">and jq.DCSJ = #{dcsj}</if>
            <if test="zdzksj != null and zdzksj != ''">and jq.ZDZKSJ = #{zdzksj}</if>
            <if test="cssj != null and cssj != ''">and jq.CSSJ = #{cssj}</if>
            <if test="hskzsj != null and hskzsj != ''">and jq.HSKZSJ = #{hskzsj}</if>
            <if test="jbpmsj != null and jbpmsj != ''">and jq.JBPMSJ = #{jbpmsj}</if>
            <if test="tssj != null and tssj != ''">and jq.TSSJ = #{tssj}</if>
            <if test="gdsj != null and gdsj != ''">and jq.GDSJ = #{gdsj}</if>
            <if test="ztfhsj != null and ztfhsj != ''">and jq.ZTFHSJ = #{ztfhsj}</if>
            <if test="xfjyjgTywysbm != null and xfjyjgTywysbm != ''">and jq.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}</if>
            <if test="xzqhdm != null and xzqhdm != ''">and jq.XZQHDM = #{xzqhdm}</if>
            <if test="jzjglxdm != null and jzjglxdm != ''">and jq.JZJGLXDM = #{jzjglxdm}</if>
            <if test="ywqkdm != null and ywqkdm != ''">and jq.YWQKDM = #{ywqkdm}</if>
            <if test="zhcsdm != null and zhcsdm != ''">and jq.ZHCSDM = #{zhcsdm}</if>
            <if test="rswdm != null and rswdm != ''">and jq.RSWDM = #{rswdm}</if>
            <if test="bkrs != null and bkrs != ''">and jq.BKRS = #{bkrs}</if>
            <if test="rysw != null and rysw != ''">and jq.RYSW = #{rysw}</if>
            <if test="cperson != null and cperson != ''">and jq.cperson = #{cperson}</if>
            <if test="cdate != null and cdate != ''">and jq.cdate = #{cdate}</if>
            <if test="status != null and status != ''">and jq.status = #{status}</if>
            <if test="jlrTywysbm != null and jlrTywysbm != ''">and dz.XFJYJG_TYWYSBM = #{jlrTywysbm}</if>
            <if test="dateStatus=='1'">and TO_DAYS(jq.cdate) = TO_DAYS(NOW());   -- 本日</if>
            <if test="dateStatus=='2'">and YEARWEEK(DATE_FORMAT(jq.cdate,'%Y-%m-%d')) = YEARWEEK(NOW()); -- 本周</if>
            <if test="dateStatus=='3'">and jqxx_jbxx j WHERE DATE_FORMAT(jq.cdate,'%Y%m') = DATE_FORMAT(CURDATE(),'%Y%m'); -- 本月</if>
        </where>
    </select>
    <insert id="save" parameterType="com.smart119.webapi.domain.JbxxDO">
		insert into jqxx_jbxx
		(
			`JQ_TYWYSBM`,
			`BJ_TYWYSBM`,
			`MC`,
			`DDMC`,
			`JQFLYDM`,
			`JQDJDM`,
			`JQZT_LBDM`,
			`JQZT_RQSJ`,
			`JQDX_TYWYSBM`,
			`JQDX_MC`,
			`JQDX_JYQK`,
			`JQ_JYQK`,
			`JQBSLBDM`,
			`LC`,
			`DQJD`,
			`DQWD`,
			`BJRXM`,
			`BJDH`,
			`BJFSLBDM`,
			`BJSJ`,
			`LASJ`,
			`JASJ`,
			`JSMLSJ`,
			`CDSJ`,
			`DCSJ`,
			`ZDZKSJ`,
			`CSSJ`,
			`HSKZSJ`,
			`JBPMSJ`,
			`TSSJ`,
			`GDSJ`,
			`ZTFHSJ`,
			`XFJYJG_TYWYSBM`,
			`XZQHDM`,
			`JZJGLXDM`,
			`YWQKDM`,
			`ZHCSDM`,
			`RSWDM`,
			`BKRS`,
			`RYSW`,
			`cperson`,
			`cdate`,
			`status`
		)
		values
		(
			#{jqTywysbm},
			#{bjTywysbm},
			#{mc},
			#{ddmc},
			#{jqflydm},
			#{jqdjdm},
			#{jqztLbdm},
			#{jqztRqsj},
			#{jqdxTywysbm},
			#{jqdxMc},
			#{jqdxJyqk},
			#{jqJyqk},
			#{jqbslbdm},
			#{lc},
			#{dqjd},
			#{dqwd},
			#{bjrxm},
			#{bjdh},
			#{bjfslbdm},
			#{bjsj},
			#{lasj},
			#{jasj},
			#{jsmlsj},
			#{cdsj},
			#{dcsj},
			#{zdzksj},
			#{cssj},
			#{hskzsj},
			#{jbpmsj},
			#{tssj},
			#{gdsj},
			#{ztfhsj},
			#{xfjyjgTywysbm},
			#{xzqhdm},
			#{jzjglxdm},
			#{ywqkdm},
			#{zhcsdm},
			#{rswdm},
			#{bkrs},
			#{rysw},
			#{cperson},
			#{cdate},
			#{status}
		)
	</insert>

    <update id="update" parameterType="com.smart119.webapi.domain.JbxxDO">
        update jqxx_jbxx
        <set>
            <if test="bjTywysbm != null">`BJ_TYWYSBM` = #{bjTywysbm},</if>
            <if test="mc != null">`MC` = #{mc},</if>
            <if test="ddmc != null">`DDMC` = #{ddmc},</if>
            <if test="jqflydm != null">`JQFLYDM` = #{jqflydm},</if>
            <if test="jqdjdm != null">`JQDJDM` = #{jqdjdm},</if>
            <if test="jqztLbdm != null">`JQZT_LBDM` = #{jqztLbdm},</if>
            <if test="jqztRqsj != null">`JQZT_RQSJ` = #{jqztRqsj},</if>
            <if test="jqdxTywysbm != null">`JQDX_TYWYSBM` = #{jqdxTywysbm},</if>
            <if test="jqdxMc != null">`JQDX_MC` = #{jqdxMc},</if>
            <if test="jqdxJyqk != null">`JQDX_JYQK` = #{jqdxJyqk},</if>
            <if test="jqJyqk != null">`JQ_JYQK` = #{jqJyqk},</if>
            <if test="jqbslbdm != null">`JQBSLBDM` = #{jqbslbdm},</if>
            <if test="lc != null">`LC` = #{lc},</if>
            <if test="dqjd != null">`DQJD` = #{dqjd},</if>
            <if test="dqwd != null">`DQWD` = #{dqwd},</if>
            <if test="bjrxm != null">`BJRXM` = #{bjrxm},</if>
            <if test="bjdh != null">`BJDH` = #{bjdh},</if>
            <if test="bjfslbdm != null">`BJFSLBDM` = #{bjfslbdm},</if>
            <if test="bjsj != null">`BJSJ` = #{bjsj},</if>
            <if test="lasj != null">`LASJ` = #{lasj},</if>
            <if test="jasj != null">`JASJ` = #{jasj},</if>
            <if test="jsmlsj != null">`JSMLSJ` = #{jsmlsj},</if>
            <if test="cdsj != null">`CDSJ` = #{cdsj},</if>
            <if test="dcsj != null">`DCSJ` = #{dcsj},</if>
            <if test="zdzksj != null">`ZDZKSJ` = #{zdzksj},</if>
            <if test="cssj != null">`CSSJ` = #{cssj},</if>
            <if test="hskzsj != null">`HSKZSJ` = #{hskzsj},</if>
            <if test="jbpmsj != null">`JBPMSJ` = #{jbpmsj},</if>
            <if test="tssj != null">`TSSJ` = #{tssj},</if>
            <if test="gdsj != null">`GDSJ` = #{gdsj},</if>
            <if test="ztfhsj != null">`ZTFHSJ` = #{ztfhsj},</if>
            <if test="xfjyjgTywysbm != null">`XFJYJG_TYWYSBM` = #{xfjyjgTywysbm},</if>
            <if test="xzqhdm != null">`XZQHDM` = #{xzqhdm},</if>
            <if test="jzjglxdm != null">`JZJGLXDM` = #{jzjglxdm},</if>
            <if test="ywqkdm != null">`YWQKDM` = #{ywqkdm},</if>
            <if test="zhcsdm != null">`ZHCSDM` = #{zhcsdm},</if>
            <if test="rswdm != null">`RSWDM` = #{rswdm},</if>
            <if test="bkrs != null">`BKRS` = #{bkrs},</if>
            <if test="rysw != null">`RYSW` = #{rysw},</if>
            <if test="cperson != null">`cperson` = #{cperson},</if>
            <if test="cdate != null">`cdate` = #{cdate},</if>
            <if test="status != null">`status` = #{status},</if>
            <if test="parentNodeId != null">`parentNodeId` = #{parentNodeId}</if>
        </set>
        where JQ_TYWYSBM = #{jqTywysbm}
    </update>

    <delete id="remove">
		delete from jqxx_jbxx where JQ_TYWYSBM = #{value}
	</delete>

    <delete id="batchRemove">
        delete from jqxx_jbxx where JQ_TYWYSBM in
        <foreach item="jqTywysbm" collection="array" open="(" separator="," close=")">
            #{jqTywysbm}
        </foreach>
    </delete>

    <select id="jqlxTypeList" resultType="com.smart119.webapi.domain.WebjbxxDO">
        SELECT distinct
        (SELECT COUNT(*)  FROM (SELECT
        count(*)
        FROM
        jqxx_jbxx ,
        jqxx_jqcjdp,
        jqxx_jqcjdp_dz
        where 1=1
        AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '1'
        AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
        AND jqxx_jbxx. STATUS = '0'
        AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
        AND jqxx_jqcjdp. STATUS = '0'
        AND jqxx_jqcjdp_dz.`status` = '0'
        AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
        <if test="state == 1">
            and DATEDIFF(JQZT_RQSJ,NOW())=0
        </if>
        <if test="state == 2">
            and DATEDIFF(JQZT_RQSJ,NOW())=-1
        </if>
        <if test="state == 3">
            and YEARWEEK(date_format(JQZT_RQSJ,'%Y-%m-%d')) = YEARWEEK(now())
        </if>
        <if test="state == 4">
            AND DATE_FORMAT( JQZT_RQSJ, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )
        </if>
        <if test="state == 5">
        </if>
        group by jqxx_jbxx.JQ_TYWYSBM) B) as count,
        '火灾救援' AS mc,
        CONCAT(
        CAST(
        round(
        (
        (SELECT COUNT(*)  FROM (SELECT
        count(*)
        FROM
        jqxx_jbxx ,
        jqxx_jqcjdp,
        jqxx_jqcjdp_dz
        where 1=1
        AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '1'
        AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
        AND jqxx_jbxx. STATUS = '0'
        AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
        AND jqxx_jqcjdp. STATUS = '0'
        AND jqxx_jqcjdp_dz.`status` = '0'
        AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
        <if test="state == 1">
            and DATEDIFF(JQZT_RQSJ,NOW())=0
        </if>
        <if test="state == 2">
            and DATEDIFF(JQZT_RQSJ,NOW())=-1
        </if>
        <if test="state == 3">
            and YEARWEEK(date_format(JQZT_RQSJ,'%Y-%m-%d')) = YEARWEEK(now())
        </if>
        <if test="state == 4">
            AND DATE_FORMAT( JQZT_RQSJ, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )
        </if>
        <if test="state == 5">
        </if>
        group by jqxx_jbxx.JQ_TYWYSBM) B) / (
        select COUNT(*)  FROM (SELECT
        count(*)
        FROM
        jqxx_jbxx ,
        jqxx_jqcjdp,
        jqxx_jqcjdp_dz
        where 1=1
        AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
        AND jqxx_jbxx. STATUS = '0'
        AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
        AND jqxx_jqcjdp. STATUS = '0'
        AND jqxx_jqcjdp_dz.`status` = '0'
        AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}

        <if test="state == 1">
            and DATEDIFF(JQZT_RQSJ,NOW())=0
        </if>
        <if test="state == 2">
            and DATEDIFF(JQZT_RQSJ,NOW())=-1
        </if>
        <if test="state == 3">
            and YEARWEEK(date_format(JQZT_RQSJ,'%Y-%m-%d')) = YEARWEEK(now())
        </if>
        <if test="state == 4">
            AND DATE_FORMAT( JQZT_RQSJ, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )
        </if>
        <if test="state == 5">
        </if>
        group by jqxx_jbxx.JQ_TYWYSBM )A
        )
        ) * 100,
        3
        ) AS CHAR
        ),
        '%'
        ) AS percentage
        FROM
        jqxx_jqcjdp_dz C
        WHERE
        C. STATUS = '0'
        AND C.XFJYJG_TYWYSBM =  #{xfjyjgTywysbm}
        UNION ALL
        SELECT distinct
        (SELECT COUNT(*)  FROM (SELECT
        count(*)
        FROM
        jqxx_jbxx ,
        jqxx_jqcjdp,
        jqxx_jqcjdp_dz
        where 1=1
        AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '2'
        AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
        AND jqxx_jbxx. STATUS = '0'
        AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
        AND jqxx_jqcjdp. STATUS = '0'
        AND jqxx_jqcjdp_dz.`status` = '0'
        AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
        <if test="state == 1">
            and DATEDIFF(JQZT_RQSJ,NOW())=0
        </if>
        <if test="state == 2">
            and DATEDIFF(JQZT_RQSJ,NOW())=-1
        </if>
        <if test="state == 3">
            and YEARWEEK(date_format(JQZT_RQSJ,'%Y-%m-%d')) = YEARWEEK(now())
        </if>
        <if test="state == 4">
            AND DATE_FORMAT( JQZT_RQSJ, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )
        </if>
        <if test="state == 5">
        </if>
        group by jqxx_jbxx.JQ_TYWYSBM) B) as count,
        '抢险救援' AS mc,
        CONCAT(
        CAST(
        round(
        (
        (SELECT COUNT(*)  FROM (SELECT
        count(*)
        FROM
        jqxx_jbxx ,
        jqxx_jqcjdp,
        jqxx_jqcjdp_dz
        where 1=1
        AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '2'
        AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
        AND jqxx_jbxx. STATUS = '0'
        AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
        AND jqxx_jqcjdp. STATUS = '0'
        AND jqxx_jqcjdp_dz.`status` = '0'
        AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
        <if test="state == 1">
            and DATEDIFF(JQZT_RQSJ,NOW())=0
        </if>
        <if test="state == 2">
            and DATEDIFF(JQZT_RQSJ,NOW())=-1
        </if>
        <if test="state == 3">
            and YEARWEEK(date_format(JQZT_RQSJ,'%Y-%m-%d')) = YEARWEEK(now())
        </if>
        <if test="state == 4">
            AND DATE_FORMAT( JQZT_RQSJ, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )
        </if>
        <if test="state == 5">
        </if>
        group by jqxx_jbxx.JQ_TYWYSBM) B) / (
        select COUNT(*)  FROM (SELECT
        count(*)
        FROM
        jqxx_jbxx ,
        jqxx_jqcjdp,
        jqxx_jqcjdp_dz
        where 1=1
        AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
        AND jqxx_jbxx. STATUS = '0'
        AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
        AND jqxx_jqcjdp. STATUS = '0'
        AND jqxx_jqcjdp_dz.`status` = '0'
        AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}

        <if test="state == 1">
            and DATEDIFF(JQZT_RQSJ,NOW())=0
        </if>
        <if test="state == 2">
            and DATEDIFF(JQZT_RQSJ,NOW())=-1
        </if>
        <if test="state == 3">
            and YEARWEEK(date_format(JQZT_RQSJ,'%Y-%m-%d')) = YEARWEEK(now())
        </if>
        <if test="state == 4">
            AND DATE_FORMAT( JQZT_RQSJ, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )
        </if>
        <if test="state == 5">
        </if>
        group by jqxx_jbxx.JQ_TYWYSBM )A
        )
        ) * 100,
        3
        ) AS CHAR
        ),
        '%'
        ) AS percentage
        FROM
        jqxx_jqcjdp_dz C
        WHERE
        C. STATUS = '0'
        AND C.XFJYJG_TYWYSBM =  #{xfjyjgTywysbm}
        UNION ALL
        SELECT distinct
        (SELECT COUNT(*)  FROM (SELECT
        count(*)
        FROM
        jqxx_jbxx ,
        jqxx_jqcjdp,
        jqxx_jqcjdp_dz
        where 1=1
        AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '3'
        AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
        AND jqxx_jbxx. STATUS = '0'
        AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
        AND jqxx_jqcjdp. STATUS = '0'
        AND jqxx_jqcjdp_dz.`status` = '0'
        AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
        <if test="state == 1">
            and DATEDIFF(JQZT_RQSJ,NOW())=0
        </if>
        <if test="state == 2">
            and DATEDIFF(JQZT_RQSJ,NOW())=-1
        </if>
        <if test="state == 3">
            and YEARWEEK(date_format(JQZT_RQSJ,'%Y-%m-%d')) = YEARWEEK(now())
        </if>
        <if test="state == 4">
            AND DATE_FORMAT( JQZT_RQSJ, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )
        </if>
        <if test="state == 5">
        </if>
        group by jqxx_jbxx.JQ_TYWYSBM) B) as count,
        '反恐排爆' AS mc,
        CONCAT(
        CAST(
        round(
        (
        (SELECT COUNT(*)  FROM (SELECT
        count(*)
        FROM
        jqxx_jbxx ,
        jqxx_jqcjdp,
        jqxx_jqcjdp_dz
        where 1=1
        AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '3'
        AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
        AND jqxx_jbxx. STATUS = '0'
        AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
        AND jqxx_jqcjdp. STATUS = '0'
        AND jqxx_jqcjdp_dz.`status` = '0'
        AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
        <if test="state == 1">
            and DATEDIFF(JQZT_RQSJ,NOW())=0
        </if>
        <if test="state == 2">
            and DATEDIFF(JQZT_RQSJ,NOW())=-1
        </if>
        <if test="state == 3">
            and YEARWEEK(date_format(JQZT_RQSJ,'%Y-%m-%d')) = YEARWEEK(now())
        </if>
        <if test="state == 4">
            AND DATE_FORMAT( JQZT_RQSJ, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )
        </if>
        <if test="state == 5">
        </if>
        group by jqxx_jbxx.JQ_TYWYSBM) B) / (
        select COUNT(*)  FROM (SELECT
        count(*)
        FROM
        jqxx_jbxx ,
        jqxx_jqcjdp,
        jqxx_jqcjdp_dz
        where 1=1
        AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
        AND jqxx_jbxx. STATUS = '0'
        AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
        AND jqxx_jqcjdp. STATUS = '0'
        AND jqxx_jqcjdp_dz.`status` = '0'
        AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}

        <if test="state == 1">
            and DATEDIFF(JQZT_RQSJ,NOW())=0
        </if>
        <if test="state == 2">
            and DATEDIFF(JQZT_RQSJ,NOW())=-1
        </if>
        <if test="state == 3">
            and YEARWEEK(date_format(JQZT_RQSJ,'%Y-%m-%d')) = YEARWEEK(now())
        </if>
        <if test="state == 4">
            AND DATE_FORMAT( JQZT_RQSJ, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )
        </if>
        <if test="state == 5">
        </if>
        group by jqxx_jbxx.JQ_TYWYSBM )A
        )
        ) * 100,
        3
        ) AS CHAR
        ),
        '%'
        ) AS percentage
        FROM
        jqxx_jqcjdp_dz C
        WHERE
        C. STATUS = '0'
        AND C.XFJYJG_TYWYSBM =  #{xfjyjgTywysbm}
        UNION ALL
        SELECT distinct
        (SELECT COUNT(*)  FROM (SELECT
        count(*)
        FROM
        jqxx_jbxx ,
        jqxx_jqcjdp,
        jqxx_jqcjdp_dz
        where 1=1
        AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '4'
        AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
        AND jqxx_jbxx. STATUS = '0'
        AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
        AND jqxx_jqcjdp. STATUS = '0'
        AND jqxx_jqcjdp_dz.`status` = '0'
        AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
        <if test="state == 1">
            and DATEDIFF(JQZT_RQSJ,NOW())=0
        </if>
        <if test="state == 2">
            and DATEDIFF(JQZT_RQSJ,NOW())=-1
        </if>
        <if test="state == 3">
            and YEARWEEK(date_format(JQZT_RQSJ,'%Y-%m-%d')) = YEARWEEK(now())
        </if>
        <if test="state == 4">
            AND DATE_FORMAT( JQZT_RQSJ, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )
        </if>
        <if test="state == 5">
        </if>
        group by jqxx_jbxx.JQ_TYWYSBM) B) as count,
        '公务执勤' AS mc,
        CONCAT(
        CAST(
        round(
        (
        (SELECT COUNT(*)  FROM (SELECT
        count(*)
        FROM
        jqxx_jbxx ,
        jqxx_jqcjdp,
        jqxx_jqcjdp_dz
        where 1=1
        AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '4'
        AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
        AND jqxx_jbxx. STATUS = '0'
        AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
        AND jqxx_jqcjdp. STATUS = '0'
        AND jqxx_jqcjdp_dz.`status` = '0'
        AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
        <if test="state == 1">
            and DATEDIFF(JQZT_RQSJ,NOW())=0
        </if>
        <if test="state == 2">
            and DATEDIFF(JQZT_RQSJ,NOW())=-1
        </if>
        <if test="state == 3">
            and YEARWEEK(date_format(JQZT_RQSJ,'%Y-%m-%d')) = YEARWEEK(now())
        </if>
        <if test="state == 4">
            AND DATE_FORMAT( JQZT_RQSJ, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )
        </if>
        <if test="state == 5">
        </if>
        group by jqxx_jbxx.JQ_TYWYSBM) B) / (
        select COUNT(*)  FROM (SELECT
        count(*)
        FROM
        jqxx_jbxx ,
        jqxx_jqcjdp,
        jqxx_jqcjdp_dz
        where 1=1
        AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
        AND jqxx_jbxx. STATUS = '0'
        AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
        AND jqxx_jqcjdp. STATUS = '0'
        AND jqxx_jqcjdp_dz.`status` = '0'
        AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}

        <if test="state == 1">
            and DATEDIFF(JQZT_RQSJ,NOW())=0
        </if>
        <if test="state == 2">
            and DATEDIFF(JQZT_RQSJ,NOW())=-1
        </if>
        <if test="state == 3">
            and YEARWEEK(date_format(JQZT_RQSJ,'%Y-%m-%d')) = YEARWEEK(now())
        </if>
        <if test="state == 4">
            AND DATE_FORMAT( JQZT_RQSJ, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )
        </if>
        <if test="state == 5">
        </if>
        group by jqxx_jbxx.JQ_TYWYSBM )A
        )
        ) * 100,
        3
        ) AS CHAR
        ),
        '%'
        ) AS percentage
        FROM
        jqxx_jqcjdp_dz C
        WHERE
        C. STATUS = '0'
        AND C.XFJYJG_TYWYSBM =  #{xfjyjgTywysbm}
        UNION ALL
        SELECT distinct
        (SELECT COUNT(*)  FROM (SELECT
        count(*)
        FROM
        jqxx_jbxx ,
        jqxx_jqcjdp,
        jqxx_jqcjdp_dz
        where 1=1
        AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '5'
        AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
        AND jqxx_jbxx. STATUS = '0'
        AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
        AND jqxx_jqcjdp. STATUS = '0'
        AND jqxx_jqcjdp_dz.`status` = '0'
        AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
        <if test="state == 1">
            and DATEDIFF(JQZT_RQSJ,NOW())=0
        </if>
        <if test="state == 2">
            and DATEDIFF(JQZT_RQSJ,NOW())=-1
        </if>
        <if test="state == 3">
            and YEARWEEK(date_format(JQZT_RQSJ,'%Y-%m-%d')) = YEARWEEK(now())
        </if>
        <if test="state == 4">
            AND DATE_FORMAT( JQZT_RQSJ, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )
        </if>
        <if test="state == 5">
        </if>
        group by jqxx_jbxx.JQ_TYWYSBM) B) as count,
        '社会救助' AS mc,
        CONCAT(
        CAST(
        round(
        (
        (SELECT COUNT(*)  FROM (SELECT
        count(*)
        FROM
        jqxx_jbxx ,
        jqxx_jqcjdp,
        jqxx_jqcjdp_dz
        where 1=1
        AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '5'
        AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
        AND jqxx_jbxx. STATUS = '0'
        AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
        AND jqxx_jqcjdp. STATUS = '0'
        AND jqxx_jqcjdp_dz.`status` = '0'
        AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
        <if test="state == 1">
            and DATEDIFF(JQZT_RQSJ,NOW())=0
        </if>
        <if test="state == 2">
            and DATEDIFF(JQZT_RQSJ,NOW())=-1
        </if>
        <if test="state == 3">
            and YEARWEEK(date_format(JQZT_RQSJ,'%Y-%m-%d')) = YEARWEEK(now())
        </if>
        <if test="state == 4">
            AND DATE_FORMAT( JQZT_RQSJ, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )
        </if>
        <if test="state == 5">
        </if>
        group by jqxx_jbxx.JQ_TYWYSBM) B) / (
        select COUNT(*)  FROM (SELECT
        count(*)
        FROM
        jqxx_jbxx ,
        jqxx_jqcjdp,
        jqxx_jqcjdp_dz
        where 1=1
        AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
        AND jqxx_jbxx. STATUS = '0'
        AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
        AND jqxx_jqcjdp. STATUS = '0'
        AND jqxx_jqcjdp_dz.`status` = '0'
        AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}

        <if test="state == 1">
            and DATEDIFF(JQZT_RQSJ,NOW())=0
        </if>
        <if test="state == 2">
            and DATEDIFF(JQZT_RQSJ,NOW())=-1
        </if>
        <if test="state == 3">
            and YEARWEEK(date_format(JQZT_RQSJ,'%Y-%m-%d')) = YEARWEEK(now())
        </if>
        <if test="state == 4">
            AND DATE_FORMAT( JQZT_RQSJ, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )
        </if>
        <if test="state == 5">
        </if>
        group by jqxx_jbxx.JQ_TYWYSBM )A
        )
        ) * 100,
        3
        ) AS CHAR
        ),
        '%'
        ) AS percentage
        FROM
        jqxx_jqcjdp_dz C
        WHERE
        C. STATUS = '0'
        AND C.XFJYJG_TYWYSBM =  #{xfjyjgTywysbm}
        UNION ALL
        SELECT distinct
        (SELECT COUNT(*)  FROM (SELECT
        count(*)
        FROM
        jqxx_jbxx ,
        jqxx_jqcjdp,
        jqxx_jqcjdp_dz
        where 1=1
        AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '6'
        AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
        AND jqxx_jbxx. STATUS = '0'
        AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
        AND jqxx_jqcjdp. STATUS = '0'
        AND jqxx_jqcjdp_dz.`status` = '0'
        AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
        <if test="state == 1">
            and DATEDIFF(JQZT_RQSJ,NOW())=0
        </if>
        <if test="state == 2">
            and DATEDIFF(JQZT_RQSJ,NOW())=-1
        </if>
        <if test="state == 3">
            and YEARWEEK(date_format(JQZT_RQSJ,'%Y-%m-%d')) = YEARWEEK(now())
        </if>
        <if test="state == 4">
            AND DATE_FORMAT( JQZT_RQSJ, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )
        </if>
        <if test="state == 5">
        </if>
        group by jqxx_jbxx.JQ_TYWYSBM) B) as count,
        '其他出动' AS mc,
        CONCAT(
        CAST(
        round(
        (
        (SELECT COUNT(*)  FROM (SELECT
        count(*)
        FROM
        jqxx_jbxx ,
        jqxx_jqcjdp,
        jqxx_jqcjdp_dz
        where 1=1
        AND LEFT (jqxx_jbxx.JQFLYDM, 1) = '6'
        AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
        AND jqxx_jbxx. STATUS = '0'
        AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
        AND jqxx_jqcjdp. STATUS = '0'
        AND jqxx_jqcjdp_dz.`status` = '0'
        AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}
        <if test="state == 1">
            and DATEDIFF(JQZT_RQSJ,NOW())=0
        </if>
        <if test="state == 2">
            and DATEDIFF(JQZT_RQSJ,NOW())=-1
        </if>
        <if test="state == 3">
            and YEARWEEK(date_format(JQZT_RQSJ,'%Y-%m-%d')) = YEARWEEK(now())
        </if>
        <if test="state == 4">
            AND DATE_FORMAT( JQZT_RQSJ, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )
        </if>
        <if test="state == 5">
        </if>
        group by jqxx_jbxx.JQ_TYWYSBM) B) / (
        select COUNT(*)  FROM (SELECT
        count(*)
        FROM
        jqxx_jbxx ,
        jqxx_jqcjdp,
        jqxx_jqcjdp_dz
        where 1=1
        AND jqxx_jqcjdp.JQCJDP_TYWYSBM = jqxx_jqcjdp_dz.DP_TYWYSBM
        AND jqxx_jbxx. STATUS = '0'
        AND jqxx_jbxx.JQ_TYWYSBM = jqxx_jqcjdp.JQ_TYWYSBM
        AND jqxx_jqcjdp. STATUS = '0'
        AND jqxx_jqcjdp_dz.`status` = '0'
        AND jqxx_jqcjdp_dz.XFJYJG_TYWYSBM = #{xfjyjgTywysbm}

        <if test="state == 1">
            and DATEDIFF(JQZT_RQSJ,NOW())=0
        </if>
        <if test="state == 2">
            and DATEDIFF(JQZT_RQSJ,NOW())=-1
        </if>
        <if test="state == 3">
            and YEARWEEK(date_format(JQZT_RQSJ,'%Y-%m-%d')) = YEARWEEK(now())
        </if>
        <if test="state == 4">
            AND DATE_FORMAT( JQZT_RQSJ, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )
        </if>
        <if test="state == 5">
        </if>
        group by jqxx_jbxx.JQ_TYWYSBM )A
        )
        ) * 100,
        3
        ) AS CHAR
        ),
        '%'
        ) AS percentage
        FROM
        jqxx_jqcjdp_dz C
        WHERE
        C. STATUS = '0'
        AND C.XFJYJG_TYWYSBM =  #{xfjyjgTywysbm}
    </select>


    <select id="getJqAll" parameterType="java.util.HashMap">
        SELECT
        DATE_FORMAT(thjl.JIT_RQSJ,'%Y-%m-%d %H:%i:%s') as jjsj,
        DATE_FORMAT(thjl.ZL_RQSJ,'%Y-%m-%d %H:%i:%s') as bjsj,
        '电话' as bjfs,
        thjl.ZJHM_LXDH as dhhm,
        jq.DDMC as jqdz,
        jq.JQFLYDM as jqlx,
        jq.JQDJDM as jqdj,
        jq.XFJYJG_TYWYSBM as zgdz,
        jq.BJRXM as lxr,
        jq.BJDH as lxdh,
        jq.ZHCSDM as zhcs,
        jq.RSWDM as rsw,
        jq.YWQKDM as ywqk,
        jq.BKRS as bkrs,
        jq.RYSW as rysw,
        jq.JQ_JYQK as jqms,
        jq.JQDX_TYWYSBM as zddw

        FROM jqxx_jbxx jq
        LEFT JOIN jqxx_bjjl bjjl
        on jq.BJ_TYWYSBM = bjjl.BJ_TYWYSBM
        LEFT JOIN jqxx_thjl thjl
        on thjl.THJL_TYWYSBM = bjjl.THJL_TYWYSBM
        where jq.JQ_TYWYSBM = #{value}

    </select>

    <select id="jqsxxx" parameterType="java.util.HashMap">
        SELECT
        sx.DTSX_TYWYSBM as dtsxTywysbm,
        sx.SXM as sxm,
        sxz.SXZ as sxz
        from jqxx_dtsx sx
        LEFT JOIN jqxx_dtsxz sxz
        on sx.DTSX_TYWYSBM = sxz.DTSX_TYWYSBM
        where sx.ZHCS_ID = #{value}
    </select>

    <select id="getJqxxByJqTywysbm" resultType="com.smart119.webapi.domain.JbxxDO">
		select jq.JQ_TYWYSBM,jq.BJ_TYWYSBM,jq.DDMC,jq.JQFLYDM,getAllDictByChildId(d.id) JQFL,jq.JQDJDM,d1.`name` JQDJ,jq.XFJYJG_TYWYSBM,dept.`DWMC` ZGDZ,jq.BJRXM,jq.BJDH,jq.ZHCSDM,d2.`name` ZHCS,jq.RSWDM,getAllDictByChildId(d3.id) RSW,zddw.DWMC ZDDW,jq.YWQKDM,d4.`name` YWQK,jq.BKRS,jq.RYSW,jq.JQ_JYQK,jq.DQJD,jq.DQWD
		from jqxx_jbxx jq
		left join sys_dict d on jq.JQFLYDM=d.`value` and d.type='JQFLYDM'
		left join sys_dict d1 on d1.`value`=jq.JQDJDM and d1.type='JQDJDM'
		left join sys_dept dept on dept.XFJYJG_TYWYSBM = jq.XFJYJG_TYWYSBM
		left join sys_dict d2 on d2.`value`=jq.ZHCSDM and d2.type='ZHCS'
		left join sys_dict d3 on d3.`value`=jq.RSWDM and d3.type='RSWDM'
		left join jczy_zddw zddw on zddw.ZDDW_TYWYSBM = jq.JQDX_TYWYSBM
		left join sys_dict d4 on d4.`value`=jq.YWQKDM and d4.type='YWQKDM'
		where jq.JQ_TYWYSBM=#{jqTywysbm}
	</select>

    <select id="getDzJqInfo" resultType="java.util.Map">
        SELECT
	i.`JQ_TYWYSBM`,
	i.`BJ_TYWYSBM`,
	i.`MC`,
	i.`DDMC`,
	(
	SELECT
		d1.`name`
	FROM
		sys_dict d1
	WHERE
		d1.type = 'JQFLYDM'
	AND d1.`value` = CONCAT( LEFT ( i.JQFLYDM, 1 ), '0000' )) AS JQFLYDM,
	dj.`name` AS JQDJDM,
	zt.`name` AS JQZT_LBDM,
	d.DWMC AS jgdwmc,
	i.BJRXM,
	i.BJDH,
	dw.DWMC,
	rsw.NAME AS rsbw,
	zh.NAME AS zhcs,
	yw.NAME AS ywqk,
	i.BKRS,
	i.RYSW,
	i.JQ_JYQK,
	dwlx.NAME AS dwlx,
	hyfl.NAME AS hyfl,
	dw.NBXFSS_JYQK,
	dw.FHSS_JYQK,
	att.attachment_id,i.CDSJ,i.JSMLSJ,i.ZDZKSJ,i.CSSJ,i.HSKZSJ,i.JBPMSJ,i.GDSJ,i.BJSJ,i.DQJD,i.DQWD,i.LASJ
FROM
	jqxx_jbxx i
	LEFT JOIN jczy_jqgd gd ON gd.JQ_TYWYSBM = i.JQ_TYWYSBM
	LEFT JOIN sys_attachment att ON att.fid = gd.JQGDJL_TYWYSBM
	LEFT JOIN sys_dict dj ON dj.`value` = i.JQDJDM
	AND dj.type = 'JQDJDM' -- 警情等级
	LEFT JOIN sys_dict zt ON zt.`value` = i.JQZT_LBDM
	AND zt.type = 'JQZTLBDM' -- 警情状态
	LEFT JOIN sys_dept d ON d.XFJYJG_TYWYSBM = i.XFJYJG_TYWYSBM
	LEFT JOIN jczy_zddw dw ON dw.ZDDW_TYWYSBM = i.JQDX_TYWYSBM
	LEFT JOIN sys_dict rsw ON rsw.`value` = i.RSWDM
	AND rsw.type = 'RSWDM' -- 燃烧物代码
	LEFT JOIN sys_dict zh ON zh.`value` = i.ZHCSDM
	AND zh.type = 'ZHCS' -- 灾害代码
	LEFT JOIN sys_dict yw ON yw.`value` = i.YWQKDM
	AND yw.type = 'YWQKDM' -- 烟雾代码
	LEFT JOIN sys_dict dwlx ON dwlx.`value` = dw.JJSYZLXDM
	AND dwlx.type = 'JJSYZLXDM' -- 烟雾代码
	LEFT JOIN sys_dict hyfl ON hyfl.`value` = dw.DWHZWHXFLYDM
	AND hyfl.type = 'DWHZWHXFLYDM' -- 行业分类
	where i.JQ_TYWYSBM=#{JQ_TYWYSBM}
    </select>

    <select id="getBt" resultType="String">
        select A.DWMC from sys_dept A WHERE A.XFJYJG_TYWYSBM= #{xfjyjgTywysbm}
    </select>

    <select id="getBjjlByJqid" resultType="java.util.Map">
        SELECT
b.*,j.JQ_TYWYSBM,d.`name` as flname
FROM
	jqxx_bjjl b
	LEFT JOIN jqxx_jbxx j ON j.BJ_TYWYSBM = b.BJ_TYWYSBM
	LEFT JOIN sys_dict d on d.value=j.JQFLYDM and  d.type = 'JQFLYDM'
WHERE
	b.XFJYJG_TYWYSBM = #{xfjyjgTywysbm} and b.BJFSLBDM='500' and b.status=0
	order by b.cdate asc
    </select>

    <update id="updateRy">
                        UPDATE jczy_xfjyry
                SET sfcd = '0'
                WHERE
                    XFJYRY_TYWYSBM IN (
                    SELECT
                        ry.XFJYRY_TYWYSBM
                    FROM
                        jqxx_xfjgcdxx cd
                        LEFT JOIN jqxx_xfrycdxx ry ON ry.XFJG_CDDM = cd.XFJG_CDDM
                    WHERE
                        ry.XFJYRY_TYWYSBM IS NOT NULL
                    AND cd.JQ_TYWYSBM = #{jqTywysbm}
                    )
    </update>
    <update id="updateCl">
                        UPDATE jczy_xfcl
                SET CLQWZTLBDM = '200'
                WHERE
                    XFCL_TYWYSBM IN (
                    SELECT
                        cl.XFCL_TYWYSBM
                    FROM
                        jqxx_xfjgcdxx cd
                        LEFT JOIN jqxx_xfclcdxx cl ON cl.XFJG_CDDM = cd.XFJG_CDDM
                    WHERE
                        cl.XFCL_TYWYSBM IS NOT NULL
                   AND cd.JQ_TYWYSBM = #{jqTywysbm}
                    )
    </update>
</mapper>
