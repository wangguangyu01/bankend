<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.smart119.webapi.dao.WebZbdtDao">

	<select id="get" resultType="com.smart119.webapi.domain.ZbdtDO">
		select `ZHB_TYWYSBM`,`ZHB_RQ`,`ZBRY_XM`,`ZBRY_LXDH`,`ZBRY_XFZBJSLBDM`,`ZBRY_XFGWFLYDM`,`ZBRY_DWMC`,`ZFB_PDBS`,`BZ`,`XFJYJG_TYWYSBM`,`XZQHDM`,`ZBRZ_JYQK`,`cdate`,`cperson`,`status` from jczy_zbdt where ZHB_TYWYSBM = #{value}
	</select>

	<select id="list" resultType="com.smart119.webapi.domain.ZbdtDO">
		select `ZHB_TYWYSBM`,`ZHB_RQ`,`ZBRY_XM`,`ZBRY_LXDH`,`ZBRY_XFZBJSLBDM`,`ZBRY_XFGWFLYDM`,`ZBRY_DWMC`,`ZFB_PDBS`,`BZ`,`XFJYJG_TYWYSBM`,`XZQHDM`,`ZBRZ_JYQK`,`cdate`,`cperson`,`status` from jczy_zbdt
        <where>  
		  		  <if test="zhbTywysbm != null and zhbTywysbm != ''"> and ZHB_TYWYSBM = #{zhbTywysbm} </if>
		  		  <if test="zhbRq != null and zhbRq != ''"> and ZHB_RQ = #{zhbRq} </if>
		  		  <if test="zbryXm != null and zbryXm != ''"> and ZBRY_XM = #{zbryXm} </if>
		  		  <if test="zbryLxdh != null and zbryLxdh != ''"> and ZBRY_LXDH = #{zbryLxdh} </if>
		  		  <if test="zbryXfzbjslbdm != null and zbryXfzbjslbdm != ''"> and ZBRY_XFZBJSLBDM = #{zbryXfzbjslbdm} </if>
		  		  <if test="zbryXfgwflydm != null and zbryXfgwflydm != ''"> and ZBRY_XFGWFLYDM = #{zbryXfgwflydm} </if>
		  		  <if test="zbryDwmc != null and zbryDwmc != ''"> and ZBRY_DWMC = #{zbryDwmc} </if>
		  		  <if test="zfbPdbs != null and zfbPdbs != ''"> and ZFB_PDBS = #{zfbPdbs} </if>
		  		  <if test="bz != null and bz != ''"> and BZ = #{bz} </if>
		  		  <if test="xfjyjgTywysbm != null and xfjyjgTywysbm != ''"> and XFJYJG_TYWYSBM = #{xfjyjgTywysbm} </if>
		  		  <if test="xzqhdm != null and xzqhdm != ''"> and XZQHDM = #{xzqhdm} </if>
		  		  <if test="zbrzJyqk != null and zbrzJyqk != ''"> and ZBRZ_JYQK = #{zbrzJyqk} </if>
		  		  <if test="cdate != null and cdate != ''"> and cdate = #{cdate} </if>
		  		  <if test="cperson != null and cperson != ''"> and cperson = #{cperson} </if>
		  		  <if test="status != null and status != ''"> and status = #{status} </if>
		  		</where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
			<otherwise>
                order by ZHB_TYWYSBM desc
			</otherwise>
        </choose>
		<if test="offset != null and limit != null">
			limit #{offset}, #{limit}
		</if>
	</select>
	
 	<select id="count" resultType="int">
		select count(*) from jczy_zbdt
		 <where>  
		  		  <if test="zhbTywysbm != null and zhbTywysbm != ''"> and ZHB_TYWYSBM = #{zhbTywysbm} </if>
		  		  <if test="zhbRq != null and zhbRq != ''"> and ZHB_RQ = #{zhbRq} </if>
		  		  <if test="zbryXm != null and zbryXm != ''"> and ZBRY_XM = #{zbryXm} </if>
		  		  <if test="zbryLxdh != null and zbryLxdh != ''"> and ZBRY_LXDH = #{zbryLxdh} </if>
		  		  <if test="zbryXfzbjslbdm != null and zbryXfzbjslbdm != ''"> and ZBRY_XFZBJSLBDM = #{zbryXfzbjslbdm} </if>
		  		  <if test="zbryXfgwflydm != null and zbryXfgwflydm != ''"> and ZBRY_XFGWFLYDM = #{zbryXfgwflydm} </if>
		  		  <if test="zbryDwmc != null and zbryDwmc != ''"> and ZBRY_DWMC = #{zbryDwmc} </if>
		  		  <if test="zfbPdbs != null and zfbPdbs != ''"> and ZFB_PDBS = #{zfbPdbs} </if>
		  		  <if test="bz != null and bz != ''"> and BZ = #{bz} </if>
		  		  <if test="xfjyjgTywysbm != null and xfjyjgTywysbm != ''"> and XFJYJG_TYWYSBM = #{xfjyjgTywysbm} </if>
		  		  <if test="xzqhdm != null and xzqhdm != ''"> and XZQHDM = #{xzqhdm} </if>
		  		  <if test="zbrzJyqk != null and zbrzJyqk != ''"> and ZBRZ_JYQK = #{zbrzJyqk} </if>
		  		  <if test="cdate != null and cdate != ''"> and cdate = #{cdate} </if>
		  		  <if test="cperson != null and cperson != ''"> and cperson = #{cperson} </if>
		  		  <if test="status != null and status != ''"> and status = #{status} </if>
		  		</where>
	</select>
	 
	<insert id="save" parameterType="com.smart119.webapi.domain.ZbdtDO">
		insert into jczy_zbdt
		(
			`ZHB_TYWYSBM`, 
			`ZHB_RQ`, 
			`ZBRY_XM`, 
			`ZBRY_LXDH`, 
			`ZBRY_XFZBJSLBDM`, 
			`ZBRY_XFGWFLYDM`, 
			`ZBRY_DWMC`, 
			`ZFB_PDBS`, 
			`BZ`, 
			`XFJYJG_TYWYSBM`, 
			`XZQHDM`, 
			`ZBRZ_JYQK`, 
			`cdate`, 
			`cperson`, 
			`status`
		)
		values
		(
			#{zhbTywysbm}, 
			#{zhbRq}, 
			#{zbryXm}, 
			#{zbryLxdh}, 
			#{zbryXfzbjslbdm}, 
			#{zbryXfgwflydm}, 
			#{zbryDwmc}, 
			#{zfbPdbs}, 
			#{bz}, 
			#{xfjyjgTywysbm}, 
			#{xzqhdm}, 
			#{zbrzJyqk}, 
			#{cdate}, 
			#{cperson}, 
			#{status}
		)
	</insert>
	 
	<update id="update" parameterType="com.smart119.webapi.domain.ZbdtDO">
		update jczy_zbdt 
		<set>
			<if test="zhbRq != null">`ZHB_RQ` = #{zhbRq}, </if>
			<if test="zbryXm != null">`ZBRY_XM` = #{zbryXm}, </if>
			<if test="zbryLxdh != null">`ZBRY_LXDH` = #{zbryLxdh}, </if>
			<if test="zbryXfzbjslbdm != null">`ZBRY_XFZBJSLBDM` = #{zbryXfzbjslbdm}, </if>
			<if test="zbryXfgwflydm != null">`ZBRY_XFGWFLYDM` = #{zbryXfgwflydm}, </if>
			<if test="zbryDwmc != null">`ZBRY_DWMC` = #{zbryDwmc}, </if>
			<if test="zfbPdbs != null">`ZFB_PDBS` = #{zfbPdbs}, </if>
			<if test="bz != null">`BZ` = #{bz}, </if>
			<if test="xfjyjgTywysbm != null">`XFJYJG_TYWYSBM` = #{xfjyjgTywysbm}, </if>
			<if test="xzqhdm != null">`XZQHDM` = #{xzqhdm}, </if>
			<if test="zbrzJyqk != null">`ZBRZ_JYQK` = #{zbrzJyqk}, </if>
			<if test="cdate != null">`cdate` = #{cdate}, </if>
			<if test="cperson != null">`cperson` = #{cperson}, </if>
			<if test="status != null">`status` = #{status}</if>
		</set>
		where ZHB_TYWYSBM = #{zhbTywysbm}
	</update>
	
	<delete id="remove">
		delete from jczy_zbdt where ZHB_TYWYSBM = #{value}
	</delete>
	
	<delete id="batchRemove">
		delete from jczy_zbdt where ZHB_TYWYSBM in 
		<foreach item="zhbTywysbm" collection="array" open="(" separator="," close=")">
			#{zhbTywysbm}
		</foreach>
	</delete>

	<select id="zbList" resultType="com.smart119.webapi.domain.ZbdtDO">
		SELECT
		A.ZBRY_XM,
		A.ZBRY_LXDH,
		B.name AS ZBRY_XFZBJSLBDM
		FROM jczy_zbdt A,
		sys_dict B
		WHERE A.XFJYJG_TYWYSBM = #{xfjyjgTywysbm} AND A.ZHB_RQ =  DATEDIFF(A.ZHB_RQ,NOW())=0 AND A.ZBRY_XFZBJSLBDM = B.VALUE
		AND B.type = 'XFZBJSLBDM' AND A.status = '0' AND B.`value` IS NOT NULL
		ORDER BY A.ZBRY_XFZBJSLBDM
	</select>

	<select id="zbSize" resultType="int">
		SELECT count(*)
		FROM jczy_zbdt A,
		sys_dict B
		WHERE A.XFJYJG_TYWYSBM = #{xfjyjgTywysbm} AND A.ZHB_RQ = DATEDIFF(A.ZHB_RQ,NOW())=0 AND A.ZBRY_XFZBJSLBDM = B.VALUE
		AND B.type = 'XFZBJSLBDM' AND A.status = '0' AND B.`value` IS NOT NULL
		ORDER BY A.ZBRY_XFZBJSLBDM
	</select>


</mapper>